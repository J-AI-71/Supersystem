<!doctype html>
<html lang="de">
<head>
  <!-- pro-activate.html -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <base href="/Supersystem/">
  <title>Pro aktiviert · SafeShare</title>
  <link rel="canonical" href="https://j-ai-71.github.io/Supersystem/pro-activate.html">

  <!-- hreflang / Locale -->
  <link rel="alternate" href="https://j-ai-71.github.io/Supersystem/pro-activate.html" hreflang="de">
  <link rel="alternate" href="https://j-ai-71.github.io/Supersystem/pro-activate.html" hreflang="x-default">
  <meta property="og:locale" content="de_DE">

  <!-- Robots: geschützt / kein Index -->
  <meta name="robots" content="noindex,nofollow,noarchive">

  <!-- Sicherheits-CSP (sanft) -->
  <meta http-equiv="Content-Security-Policy"
        content="default-src 'self';
                 base-uri 'self';
                 form-action 'self';
                 frame-ancestors 'none';
                 object-src 'none';
                 img-src 'self' data:;
                 style-src 'self' 'unsafe-inline';
                 script-src 'self' 'unsafe-inline';
                 font-src 'self';
                 worker-src 'self';
                 manifest-src 'self';
                 connect-src 'self'">

  <!-- Meta -->
  <meta name="description" content="Aktiviert SafeShare Pro lokal im Browser nach dem Kauf-Redirect.">

  <!-- Icons / Manifest -->
  <link rel="apple-touch-icon" sizes="180x180" href="assets/icons/apple-touch-icon-180.png?v=29">
  <link rel="icon" type="image/png" sizes="32x32" href="assets/icons/icon-32-kreis.png?v=29">
  <link rel="icon" type="image/png" sizes="16x16" href="assets/icons/icon-16-kreis.png?v=29">
  <link rel="manifest" href="manifest.webmanifest?v=29">

  <!-- Styles -->
  <style>
    :root{--bg:#0b0b0b;--fg:#eaeaea;--mut:#9a9a9a;--card:#121212;--line:#2a2a2a;--btn:#1b1b1b;--ok:#1e402f;--warn:#40251e}
    html,body{height:100%}
    body{margin:0;background:var(--bg);color:var(--fg);font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,sans-serif}
    .wrap{max-width:900px;margin:0 auto;padding:22px 14px}
    h1{margin:.2em 0 .4em;font-size:1.9rem}
    h2{margin:1.0em 0 .35em;font-size:1.2rem}
    .mut{color:var(--mut)}
    .card{background:var(--card);border:1px solid var(--line);border-radius:12px;padding:14px;margin-top:12px}
    .row{display:flex;flex-wrap:wrap;gap:10px}
    .btn{display:inline-block;padding:.7rem 1rem;border-radius:10px;border:1px solid var(--line);background:var(--btn);color:#eaeaea;text-decoration:none;cursor:pointer}
    .btn.ok{background:var(--ok)}
    .btn.warn{background:var(--warn)}
    code,kbd{background:#0f0f0f;border:1px solid #2a2a2a;border-radius:6px;padding:.1rem .35rem}
    .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace}
    .badge{display:inline-block;margin-left:8px;padding:.15rem .45rem;border-radius:8px;border:1px solid var(--line);background:#172017;color:#9ed1b1;font-size:.85rem}
    footer{margin-top:18px}
    a{color:#cfe7ff}
  </style>

  <link rel="stylesheet" href="css/theme.css?v=27">

  <!-- SW-Registrierung -->
  <script src="js/sw-register.js?v=29"></script>
</head>
<body>
  <div class="wrap">
    <h1>Pro-Aktivierung <span id="stateBadge" class="badge" style="display:none">aktiv</span></h1>
    <p class="mut mono" id="origin">–</p>

    <section class="card" id="result">
      <h2 style="margin-top:0">Status</h2>
      <div id="msg">Wird geprüft …</div>
      <div class="row" style="margin-top:10px">
        <a class="btn ok" href="index.html">Zur Startseite</a>
        <a class="btn" href="pro.html">Pro-Seite</a>
        <a class="btn" href="app.html">Zur App</a>
        <a class="btn" href="tools.html">Tools</a>
      </div>
    </section>

    <section class="card">
      <h2 style="margin-top:0">Wie funktioniert das?</h2>
      <ol class="mut">
        <li>Nach dem Kauf leitet der Shop auf <code class="mono">pro-activate.html?pro=1</code> weiter.</li>
        <li>Diese Seite setzt lokal im Browser <code class="mono">localStorage["ss2_pro"]="1"</code>.</li>
        <li>Zurück auf der Startseite zeigt das Pro-Badge „aktiv“.</li>
      </ol>
      <p class="mut">Kein Server-Login, keine Cookies. Die Aktivierung ist <strong>geräte-/browserbezogen</strong>.</p>
    </section>

    <section class="card">
      <h2 style="margin-top:0">Manuell umschalten</h2>
      <div class="row">
        <button class="btn" type="button" onclick="setPro(1)">Pro aktivieren</button>
        <button class="btn warn" type="button" onclick="setPro(0)">Pro deaktivieren</button>
        <button class="btn" type="button" onclick="showLS()">LocalStorage anzeigen</button>
      </div>
      <div id="ls" class="mut mono" style="margin-top:8px">–</div>
    </section>

    <footer class="mut">
      <a href="index.html">Startseite</a> ·
      <a href="pro.html">Pro</a> ·
      <a href="help.html">Hilfe</a> ·
      <a href="status.html">Status</a> ·
      <a href="impressum.html">Impressum</a> ·
      <a href="datenschutz.html">Datenschutz</a>
    </footer>
  </div>

  <script>
  (function(){
    const $ = sel => document.querySelector(sel);
    $('#origin').textContent = 'Aufruf: ' + location.href;

    const q = new URLSearchParams(location.search);
    const param = (q.get('pro')||'').trim().toLowerCase();

    // Automatik: ?pro=1 → aktivieren, ?pro=0 → deaktivieren
    if (param === '1' || param === 'true' || param === 'yes') {
      setPro(1, true);
    } else if (param === '0' || param === 'false' || param === 'no') {
      setPro(0, true);
    } else {
      renderState('Kein Parameter gefunden. Du kannst unten manuell schalten.', getState());
    }

    // Expose
    window.setPro = setPro;
    window.showLS = showLS;

    function getState(){
      try { return localStorage.getItem('ss2_pro') === '1'; }
      catch(e){ return null; }
    }

    function setPro(on, silent){
      try{
        if (on) localStorage.setItem('ss2_pro','1');
        else    localStorage.removeItem('ss2_pro');
        renderState(on ? 'Pro wurde aktiviert.' : 'Pro wurde deaktiviert.', on);
      }catch(e){
        $('#msg').innerHTML = 'Konnte den lokalen Status nicht speichern. ' +
          'Bitte Browser-Einstellungen prüfen (Speicher/Privatmodus).';
      }
      if (!silent) showLS();
    }

    function renderState(text, isOn){
      const badge = $('#stateBadge');
      const msg = $('#msg');
      if (isOn === true){ badge.style.display='inline-block'; }
      else { badge.style.display='none'; }
      msg.innerHTML = text + '<br><span class="mut">Aktueller Zustand: <code class="mono">' +
        (isOn ? 'aktiv' : 'inaktiv') + '</code></span>';
    }

    function showLS(){
      try{
        const v = localStorage.getItem('ss2_pro');
        $('#ls').textContent = 'localStorage["ss2_pro"] = ' + JSON.stringify(v);
      }catch(e){
        $('#ls').textContent = 'LocalStorage nicht lesbar.';
      }
    }
  })();
  </script>

  <noscript><div class="wrap"><p class="mut">Hinweis: JavaScript ist erforderlich, um Pro lokal zu setzen.</p></div></noscript>
</body>
</html>
