<!-- /Supersystem/redirect-entschachteln.html -->
<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="referrer" content="no-referrer-when-downgrade">
  <base href="/Supersystem/">

  <title>Weiterleitung · SafeShare</title>
  <link rel="canonical" href="https://j-ai-71.github.io/Supersystem/redirect-entschachteln.html">
  <meta name="robots" content="noindex,nofollow">

  <!-- iOS / Icons / Manifest -->
  <link rel="apple-touch-icon" href="assets/icons/icon-180-kreis.png?v=2025-11-15-11">
  <link rel="icon" type="image/png" sizes="32x32" href="assets/icons/icon-32-kreis.png?v=2025-11-15-11">
  <link rel="manifest" href="manifest.webmanifest?v=2025-11-15-11">

  <style>
    :root{--bg:#0b0b0b;--fg:#eaeaea;--mut:#9a9a9a;--pri:#29c07e}
    html,body{margin:0;background:var(--bg);color:var(--fg);font:16px/1.6 system-ui}
    .wrap{max-width:860px;margin:auto;padding:28px 16px}
    a{color:#9aead0}
    .mut{color:var(--mut)}
    .btn{display:inline-block;padding:.6rem .9rem;border-radius:10px;background:#1b1b1b;border:1px solid #2a2a2a;color:#eaeaea;font-weight:700;text-decoration:none}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Weiterleiten …</h1>
    <p class="mut">Ziel wird bereinigt und geöffnet. Falls der automatische Sprung blockiert wird, klicke:</p>
    <p><a id="link" class="btn" href="#">Zum Ziel</a></p>
    <p class="mut" id="log"></p>
  </div>

  <script src="js/core.js?v=2025-11-15-11"></script>
  <script>
  (function(){
    const q = new URLSearchParams(location.search);
    const seed = q.get('u') || '';
    const $log = document.getElementById('log');
    const $link = document.getElementById('link');

    function clean(seedUrl){
      let url = seedUrl, steps=[], notes=[];
      try{
        if (SafeShare?.core?.unwrapWithLog){ const u=SafeShare.core.unwrapWithLog(url); url=u.url; steps=u.steps||[]; }
        if (SafeShare?.core?.cleanWithLog){ const c=SafeShare.core.cleanWithLog(url); url=c.url; notes=c.notes||[]; }
      }catch(e){ notes.push('Fehler: '+e.message); }
      return {url, info:[...steps, ...notes]};
    }

    const res = clean(seed);
    $link.href = res.url;
    $link.textContent = 'Zum Ziel: ' + res.url;
    if(res.info?.length){ $log.innerHTML = res.info.join(' · '); }
    // Auto-redirect
    try{ location.replace(res.url); }catch{ location.href = res.url; }
  })();
  </script>
  <script src="js/core.js?v=2025-11-15-16"></script>
<script src="js/sw-register.js?v=2025-11-15-16"></script>
</body>
</html>
