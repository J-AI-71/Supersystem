<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="referrer" content="no-referrer-when-downgrade">
<base href="/Supersystem/">
<title>…</title>
<title>Redirect-Analyse · SafeShare</title>
<link rel="canonical" href="https://j-ai-71.github.io/Supersystem/redirect-entschachteln.html">
<meta name="robots" content="noindex,follow">
<link rel="icon" href="assets/logo.png?v=2025-11-14-05">
<style>
:root{--bg:#0b0b0b;--fg:#eaeaea;--mut:#9a9a9a}
html,body{margin:0;background:var(--bg);color:var(--fg);font:16px/1.6 system-ui}
.wrap{max-width:960px;margin:auto;padding:28px 16px}
h1{margin:0 0 6px;font-size:26px}.mut{color:var(--mut)}
.card{background:#111;border:1px solid #1f1f1f;border-radius:12px;padding:16px;margin-top:12px}
code,pre{background:#000;border:1px solid #2a2a2a;border-radius:8px;padding:8px;color:#eaeaea}
a{color:#9aead0}
</style>
</head>
<body>
<div class="wrap">
  <h1>Redirect-Analyse</h1>
  <div class="card" id="box">Lade …</div>
  <p class="mut" style="margin-top:12px">
    <a href="app.html">Zur App</a> · <a href="index.html">Start</a>
  </p>
</div>

<script src="js/core.js?v=2025-11-14-05"></script>
<script>
(function(){
  const box = document.getElementById('box');
  const sp = new URL(location.href).searchParams;
  const raw = sp.get('u') || '';
  if(!raw){ box.textContent='Parameter „u“ fehlt.'; return; }

  const seed = SafeShare.core.normalizeSeed(raw);
  const un = SafeShare.core.unwrapWithLog(seed);
  const cl = SafeShare.core.cleanWithLog(un.url);

  const details = sp.get('details')==='1';
  const wait = sp.get('wait')==='1';

  const html = `
    <p class="mut">Eingabe (roh):</p>
    <pre>${raw.replace(/&/g,'&amp;')}</pre>
    <p class="mut">Entschachtelt:</p>
    <pre>${un.url.replace(/&/g,'&amp;')}</pre>
    <p class="mut">Ergebnis (gereinigt):</p>
    <pre>${cl.url.replace(/&/g,'&amp;')}</pre>
    ${un.steps.length||cl.notes.length?'<p class="mut">Protokoll:</p>':''}
    ${un.steps.length?('<ul>'+un.steps.map(s=>'<li>'+s+'</li>').join('')+'</ul>'):''}
    ${cl.notes.length?('<ul>'+cl.notes.map(s=>'<li>'+s+'</li>').join('')+'</ul>'):''}
    ${!wait?('<p><a href="'+cl.url+'">Jetzt zur bereinigten URL</a></p>'):''}
  `;
  box.innerHTML = html;

  if(!wait && !details){
    setTimeout(()=>{ location.href = cl.url; }, 350);
  }
})();
</script>
<script src="js/sw-register.js?v=2025-11-14-05"></script>
</body>
</html>
